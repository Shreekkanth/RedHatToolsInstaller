- name: get manifest
  get_url:
    url: "{{ katello_manifest_url }}"
    dest: "{{ katello_manifest_file }}"
  become: false
  when: katello_manifest_remote
  #  delegate_to: localhost

# - name: import manifest
#   katello_manifest:
#     username: "{{ foreman_username }}"
#     password: "{{ foreman_password }}"
#     server_url: "{{ foreman_server_url }}"
#     verify_ssl: "{{ foreman_verify_ssl }}"
#     organization: "{{ foreman_org }}"
#     manifest_path: "{{ katello_manifest_file }}"
#     state: 'present'
#   become: false
#   delegate_to: localhost

- name: import manifest
  command: "hammer subscription upload --organization '{{ foreman_org }}' --file {{ katello_manifest_file }}"
  ignore_errors: True
