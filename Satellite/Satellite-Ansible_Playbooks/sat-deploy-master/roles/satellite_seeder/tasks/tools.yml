---
- name: 'Find {{ satellite_seeder_version }} tools repo'
  shell: >
    {{ satellite_seeder_hammer }} repository info
    --organization '{{ satellite_seeder_organization }}'
    --product 'Red Hat Enterprise Linux Server'
    --name 'Red Hat Satellite Tools {{ satellite_version }} for RHEL 7 Server RPMs x86_64'
  register: satellite_seeder_tools_repo
  ignore_errors: True

- name: 'Add {{ satellite_seeder_version }} tools repo'
  shell: >
    {{ satellite_seeder_hammer }} repository-set enable
    --organization '{{ satellite_seeder_organization }}'
    --product 'Red Hat Enterprise Linux Server'
    --basearch 'x86_64'
    --name 'Red Hat Satellite Tools {{ satellite_seeder_version }} (for RHEL 7 Server) (RPMs)'
  when: satellite_seeder_tools_repo.stderr.find('not found') != -1

- name: 'Sync {{ satellite_seeder_version }} tools repo'
  shell: >
    {{ satellite_seeder_hammer }} repository synchronize
    --organization '{{ satellite_seeder_organization }}'
    --product 'Red Hat Enterprise Linux Server'
    --name 'Red Hat Satellite Tools {{ satellite_seeder_version }} for RHEL 7 Server RPMs x86_64'

- name: 'Add {{ satellite_seeder_version }} tools repo to RHEL SOE content view'
  shell: >
    {{ satellite_seeder_hammer }} content-view add-repository
    --organization '{{ satellite_seeder_organization }}'
    --repository 'Red Hat Satellite Tools {{ satellite_seeder_version }} for RHEL 7 Server RPMs x86_64'
    --name "RHEL 7 SOE"
    --product "Red Hat Enterprise Linux Server"
